<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RequestFlow - –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</title>
    <style>
        :root {
            --bg-dark: #0a0a12;
            --bg-card: #11111a;
            --bg-hover: #1a1a24;
            --border: #2a2a3a;
            --text: #e0e0ff;
            --text-light: #a0a0c0;
            --purple: #9d4edd;
            --purple-light: #c77dff;
            --neon-purple: #e0aaff;
            --cyan: #00e5ff;
            --neon-cyan: #80ffea;
            --green: #00ff9d;
            --yellow: #ffd166;
            --orange: #ff7b00;
            --neon-orange: #ff9e00;
            --red: #ff3860;
            --glow: 0 0 20px rgba(157, 78, 221, 0.3);
            --glow-strong: 0 0 30px rgba(157, 78, 221, 0.5);
            --glow-orange: 0 0 15px rgba(255, 123, 0, 0.4);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --radius: 16px;
            --radius-sm: 8px;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a0b2e 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 2px solid var(--border);
            position: relative;
        }

            .header::after {
                content: '';
                position: absolute;
                bottom: -2px;
                left: 50%;
                transform: translateX(-50%);
                width: 200px;
                height: 2px;
                background: linear-gradient(90deg, var(--orange), var(--purple));
                border-radius: 1px;
                box-shadow: var(--glow-orange);
            }

            .header h1 {
                font-size: 3.5rem;
                font-weight: 900;
                margin-bottom: 15px;
                background: linear-gradient(45deg, var(--orange), var(--purple), var(--cyan));
                -webkit-background-clip: text;
                background-clip: text;
                color: transparent;
                text-shadow: 0 5px 20px rgba(157, 78, 221, 0.3);
                animation: gradientShift 8s ease infinite;
                background-size: 200% 200%;
            }

        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-light);
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Stepper */
        .stepper {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin-bottom: 50px;
            position: relative;
        }

            .stepper::before {
                content: '';
                position: absolute;
                top: 25px;
                left: 10%;
                right: 10%;
                height: 3px;
                background: var(--border);
                z-index: 1;
            }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .step-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--bg-card);
            border: 3px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.5rem;
            margin-bottom: 15px;
            transition: var(--transition);
            color: var(--text-light);
        }

        .step.active .step-circle {
            background: var(--orange);
            border-color: var(--neon-orange);
            color: white;
            box-shadow: var(--glow-orange);
            transform: scale(1.1);
        }

        .step.completed .step-circle {
            background: var(--green);
            border-color: var(--green);
            color: white;
            box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
        }

        .step-label {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 600;
            text-align: center;
            max-width: 120px;
        }

        .step.active .step-label {
            color: var(--neon-orange);
            text-shadow: 0 0 10px rgba(255, 123, 0, 0.3);
        }

        /* Step Content */
        .step-content {
            display: none;
            animation: slideInUp 0.5s ease-out;
        }

            .step-content.active {
                display: block;
            }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .card {
            background: linear-gradient(135deg, var(--bg-card) 0%, #13131d 100%);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 35px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            height: 100%;
        }

            .card:hover {
                border-color: var(--orange);
                box-shadow: var(--glow-orange);
                transform: translateY(-5px);
            }

            .card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 3px;
                background: linear-gradient(90deg, var(--orange), var(--purple));
                border-radius: var(--radius) var(--radius) 0 0;
                box-shadow: 0 0 10px var(--orange);
            }

        .card-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .card-icon {
            font-size: 2.8rem;
            background: linear-gradient(45deg, var(--orange), var(--purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(255, 123, 0, 0.3);
        }

        .card-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--text);
        }

        .card-description {
            color: var(--text-light);
            margin-bottom: 30px;
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Controls */
        .control-group {
            margin-bottom: 25px;
        }

        .control-label {
            display: block;
            margin-bottom: 12px;
            color: var(--text);
            font-weight: 600;
            font-size: 1rem;
        }

        .control-input {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            font-size: 1rem;
            transition: var(--transition);
            font-family: 'Segoe UI', sans-serif;
        }

            .control-input:focus {
                outline: none;
                border-color: var(--orange);
                box-shadow: 0 0 0 3px rgba(255, 123, 0, 0.1);
                background: rgba(255, 123, 0, 0.05);
            }

            .control-input::placeholder {
                color: var(--text-light);
                opacity: 0.5;
            }

        /* Special placeholder for myangelwhitecat */
        #chat-room::placeholder {
            color: rgba(224, 224, 255, 0.3);
            font-style: italic;
        }

        /* Instructions */
        .instructions {
            background: rgba(255, 123, 0, 0.1);
            border: 2px solid var(--orange);
            border-radius: var(--radius-sm);
            padding: 25px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

            .instructions::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 6px;
                height: 100%;
                background: var(--orange);
                box-shadow: 0 0 10px var(--orange);
            }

        .instructions-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            color: var(--neon-orange);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .instructions-content {
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.6;
        }

            .instructions-content ul {
                margin-left: 20px;
                margin-bottom: 15px;
            }

            .instructions-content li {
                margin-bottom: 8px;
                position: relative;
                padding-left: 5px;
            }

                .instructions-content li::marker {
                    color: var(--neon-orange);
                }

        /* Role Cards */
        .role-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .role-card {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 20px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

            .role-card:hover {
                border-color: var(--orange);
                background: rgba(255, 123, 0, 0.05);
                transform: translateY(-3px);
            }

            .role-card.selected {
                border-color: var(--orange);
                background: rgba(255, 123, 0, 0.1);
                box-shadow: var(--glow-orange);
            }

            .role-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 3px;
                background: linear-gradient(90deg, var(--orange), var(--purple));
                border-radius: var(--radius-sm) var(--radius-sm) 0 0;
                opacity: 0;
                transition: var(--transition);
            }

            .role-card.selected::before {
                opacity: 1;
            }

        .role-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .role-icon {
            font-size: 1.8rem;
        }

        .role-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text);
        }

        .role-level {
            margin-left: auto;
            font-size: 0.9rem;
            color: var(--neon-orange);
            background: rgba(255, 123, 0, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
        }

        .role-description {
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .action-btn {
            flex: 1;
            padding: 18px 24px;
            background: linear-gradient(135deg, var(--orange), #ff5e00);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 60px;
        }

            .action-btn:hover {
                transform: translateY(-3px);
                box-shadow: var(--glow-orange);
                background: linear-gradient(135deg, var(--neon-orange), var(--orange));
                color: white;
            }

            .action-btn:disabled {
                opacity: 0.5;
                cursor: not-allowed;
                transform: none !important;
            }

        .action-btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border);
            color: var(--text);
        }

            .action-btn-secondary:hover {
                border-color: var(--orange);
                background: rgba(255, 123, 0, 0.1);
                color: var(--text);
            }

        .action-btn-success {
            background: linear-gradient(135deg, var(--green), #00cc88);
            color: white;
        }

            .action-btn-success:hover {
                background: linear-gradient(135deg, #00ff9d, var(--green));
                box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
            }

        /* User Management Buttons */
        .user-management-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

            .user-management-buttons .action-btn {
                padding: 12px 20px;
                min-height: 48px;
                font-size: 1rem;
            }

            .user-management-buttons .action-btn-danger {
                background: linear-gradient(135deg, var(--red), #c2185b);
                color: white;
            }

                .user-management-buttons .action-btn-danger:hover {
                    background: linear-gradient(135deg, #ff5252, var(--red));
                    box-shadow: 0 0 20px rgba(255, 56, 96, 0.3);
                }

        /* Continue Button */
        .continue-btn {
            display: block;
            width: 100%;
            max-width: 500px;
            margin: 40px auto;
            padding: 20px 40px;
            background: linear-gradient(135deg, var(--orange), var(--purple));
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 10px 30px rgba(255, 123, 0, 0.3);
        }

            .continue-btn:hover {
                transform: translateY(-5px) scale(1.02);
                box-shadow: 0 15px 40px rgba(255, 123, 0, 0.4);
            }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 123, 0, 0.3);
            border-radius: 50%;
            border-top-color: var(--orange);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: var(--radius-sm);
            color: white;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            min-width: 300px;
            max-width: 400px;
            z-index: 9999;
            animation: slideInRight 0.3s ease, fadeOut 0.3s ease 4.7s;
            animation-fill-mode: forwards;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .toast-success {
            background: linear-gradient(135deg, var(--green), #00cc88);
            border-left: 4px solid var(--green);
        }

        .toast-error {
            background: linear-gradient(135deg, var(--red), #c2185b);
            border-left: 4px solid var(--red);
        }

        .toast-warning {
            background: linear-gradient(135deg, var(--orange), #ff9800);
            border-left: 4px solid var(--orange);
        }

        .toast-info {
            background: linear-gradient(135deg, var(--purple), #7b2cbf);
            border-left: 4px solid var(--purple);
        }

        .toast button {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

            .toast button:hover {
                opacity: 1;
            }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }

            .stepper {
                flex-direction: column;
                gap: 30px;
            }

                .stepper::before {
                    display: none;
                }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }

            .role-cards {
                grid-template-columns: 1fr;
            }

            .toast {
                min-width: 250px;
                max-width: 300px;
                left: 20px;
                right: 20px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }

            .card {
                padding: 25px;
            }

            .step-circle {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .toast {
                min-width: 200px;
                max-width: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>–ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</h1>
            <div style="margin-top: 30px;">
                <button class="continue-btn" onclick="loadAndContinue()">
                    <span>üìÇ</span> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
                </button>
            </div>
        </div>

        <!-- Stepper -->
        <div class="stepper">
            <div class="step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">–ß–∞—Ç</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
            </div>
        </div>

        <!-- Step 1: Directory -->
        <div class="step-content active" id="step-1">
            <div class="instructions">
                <div class="instructions-title">
                    <span>üìå</span> –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
                </div>
                <div class="instructions-content">
                    <p><strong>–ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è osu! –∫–∞—Ä—Ç</strong></p>
                    <ul>
                        <li>–£–∫–∞–∂–∏—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ Songs –≤ –≤–∞—à–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ osu!</li>
                        <li>–ü—Ä–∏–º–µ—Ä: <code>D:\osu!\Songs</code> –∏–ª–∏ <code>C:\Games\osu!\Songs</code></li>
                        <li>–ü–∞–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å</li>
                    </ul>
                </div>
            </div>

            <div class="cards-grid">
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">üìÇ</span>
                        <span class="card-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏</span>
                    </div>
                    <p class="card-description">
                        –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç osu!
                    </p>
                    <div class="control-group">
                        <label class="control-label">–ü—É—Ç—å –∫ –ø–∞–ø–∫–µ Songs</label>
                        <input type="text" class="control-input" id="folder-path"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å...">
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn action-btn-success" onclick="saveDirectorySettings()">
                            <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 2: Chat -->
        <div class="step-content" id="step-2">
            <div class="instructions">
                <div class="instructions-title">
                    <span>üí¨</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Ç–∞
                </div>
                <div class="instructions-content">
                    <p><strong>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Twitch —á–∞—Ç—É:</strong></p>
                    <ul>
                        <li>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ Twitch –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</li>
                        <li>–ü—Ä–∏–º–µ—Ä: <code>myangelwhitecat</code></li>
                        <li>–ü—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞</li>
                    </ul>
                </div>
            </div>

            <div class="cards-grid">
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">üí¨</span>
                        <span class="card-title">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —á–∞—Ç—É</span>
                    </div>
                    <p class="card-description">
                        –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ Twitch –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —á–∞—Ç—É
                    </p>
                    <div class="control-group">
                        <label class="control-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞</label>
                        <input type="text" class="control-input" id="chat-room"
                               placeholder="myangelwhitecat" style="opacity: 0.6;">
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn action-btn-secondary" onclick="goToStep(1)">
                            <span>‚¨ÖÔ∏è</span> –ù–∞–∑–∞–¥
                        </button>
                        <button class="action-btn action-btn-success" onclick="connectToChat()" id="connect-btn">
                            <span>üîó</span> –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Users -->
        <div class="step-content" id="step-3">
            <div class="instructions">
                <div class="instructions-title">
                    <span>üë•</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º
                </div>
                <div class="instructions-content">
                    <p><strong>–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞:</strong></p>
                    <ul>
                        <li><strong>0 - –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</strong> –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–∞—Ç–∞</li>
                        <li><strong>1 - –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ –∏ –≤—ã—à–µ:</strong> –ü–æ–¥–ø–∏—Å—á–∏–∫–∏, VIP, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, —Å—Ç—Ä–∏–º–µ—Ä</li>
                        <li><strong>2 - VIP –∏ –≤—ã—à–µ:</strong> VIP, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, —Å—Ç—Ä–∏–º–µ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</li>
                        <li><strong>3 - –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Å—Ç—Ä–∏–º–µ—Ä:</strong> –î–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</li>
                        <li><strong>4 - –¢–æ–ª—å–∫–æ —Å—Ç—Ä–∏–º–µ—Ä:</strong> –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å—Ç—Ä–∏–º–æ–≤</li>
                    </ul>
                </div>
            </div>

            <div class="cards-grid">
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">üéñÔ∏è</span>
                        <span class="card-title">–£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞</span>
                    </div>
                    <p class="card-description">
                        –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–º–∞–Ω–¥–∞–º –∑–∞–≥—Ä—É–∑–∫–∏
                    </p>

                    <div class="role-cards" id="role-cards">
                        <!-- Role cards will be populated by JavaScript -->
                    </div>

                    <div class="control-group">
                        <label class="control-label">–†–µ–∂–∏–º –¥–æ—Å—Ç—É–ø–∞</label>
                        <select class="control-input" id="trusted-only">
                            <option value="false">–î–æ—Å—Ç—É–ø –ø–æ —Ä–æ–ª—è–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                            <option value="true">–¢–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">‚úÖ</span>
                        <span class="card-title">–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                    </div>
                    <p class="card-description">
                        –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫
                    </p>
                    <div class="control-group">
                        <label class="control-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                        <input type="text" class="control-input" id="allow-user"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ username...">
                    </div>
                    <div class="user-management-buttons">
                        <button class="action-btn action-btn-success" onclick="allowUser()">
                            <span>‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                        <button class="action-btn action-btn-danger" onclick="removeAllowedUser()">
                            <span>üóëÔ∏è</span> –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">‚ùå</span>
                        <span class="card-title">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                    </div>
                    <p class="card-description">
                        –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–º–∞–Ω–¥–∞–º
                    </p>
                    <div class="control-group">
                        <label class="control-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                        <input type="text" class="control-input" id="block-user"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ username...">
                    </div>
                    <div class="user-management-buttons">
                        <button class="action-btn action-btn-danger" onclick="blockUser()">
                            <span>‚õî</span> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="action-btn action-btn-success" onclick="removeBlockedUser()">
                            <span>‚úÖ</span> –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="action-btn action-btn-secondary" onclick="goToStep(2)">
                    <span>‚¨ÖÔ∏è</span> –ù–∞–∑–∞–¥
                </button>
                <button class="action-btn action-btn-success" onclick="saveAllSettings()">
                    <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
            </div>
        </div>
    </div>

    <script>
        const SERVER_URL = 'http://127.0.0.1:23140';
        let currentStep = 1;
        let selectedRoleLevel = 2; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é VIP

        // –î–∞–Ω–Ω—ã–µ –æ —Ä–æ–ª—è—Ö
        const roles = [
        {
        level: 0,
        icon: 'üîì',
        name: '–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏',
        description: '–õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–∞—Ç–∞',
        access: '–ö—Ç–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø: –ª—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–∞—Ç–∞',
        when: '–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –¥–ª—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Å—Ç—Ä–∏–º–æ–≤'
        },
        {
        level: 1,
        icon: '‚≠ê',
        name: '–ü–æ–¥–ø–∏—Å—á–∏–∫–∏ –∏ –≤—ã—à–µ',
        description: '–ü–æ–¥–ø–∏—Å—á–∏–∫–∏, VIP, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, —Å—Ç—Ä–∏–º–µ—Ä',
        access: '–ö—Ç–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø: –ø–æ–¥–ø–∏—Å—á–∏–∫–∏, VIP, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, —Å—Ç—Ä–∏–º–µ—Ä',
        when: '–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –¥–ª—è —Å—Ç—Ä–∏–º–æ–≤ —Å –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º–∏'
        },
        {
        level: 2,
        icon: 'üéñÔ∏è',
        name: 'VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –≤—ã—à–µ',
        description: 'VIP, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, —Å—Ç—Ä–∏–º–µ—Ä',
        access: '–ö—Ç–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø: VIP, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, —Å—Ç—Ä–∏–º–µ—Ä',
        when: '–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å'
        },
        {
        level: 3,
        icon: 'üëÆ',
        name: '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Å—Ç—Ä–∏–º–µ—Ä',
        description: '–¢–æ–ª—å–∫–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Å—Ç—Ä–∏–º–µ—Ä',
        access: '–ö—Ç–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø: –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Å—Ç—Ä–∏–º–µ—Ä',
        when: '–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞'
        },
        {
        level: 4,
        icon: 'üëë',
        name: '–¢–æ–ª—å–∫–æ —Å—Ç—Ä–∏–º–µ—Ä',
        description: '–¢–æ–ª—å–∫–æ —Å—Ç—Ä–∏–º–µ—Ä',
        access: '–ö—Ç–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø: —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–∏–º–µ—Ä',
        when: '–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å—Ç—Ä–∏–º–æ–≤'
        }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
        try {
        initRoleCards();
        loadCurrentSettings();
        } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
        showToast('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + error.message, 'error');
        }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–æ–ª–µ–π
        function initRoleCards() {
        const container = document.getElementById('role-cards');
        if (!container) return;

        container.innerHTML = '';

        roles.forEach(role => {
        const card = document.createElement('div');
        card.className = `role-card ${role.level === selectedRoleLevel ? 'selected' : ''}`;
        card.dataset.level = role.level;
        card.onclick = () => selectRole(role.level);

        card.innerHTML = `
        <div class="role-header">
        <span class="role-icon">${role.icon}</span>
        <span class="role-name">${role.name}</span>
        <span class="role-level">–£—Ä–æ–≤–µ–Ω—å ${role.level}</span>
        </div>
        <div class="role-description">${role.description}</div>
        <div style="font-size: 0.85rem; color: var(--text-light); margin-top: 8px;">
        ${role.access}
        </div>
        `;

        container.appendChild(card);
        });
        }

        // –í—ã–±–æ—Ä —Ä–æ–ª–∏
        function selectRole(level) {
        selectedRoleLevel = level;

        // –û–±–Ω–æ–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ
        document.querySelectorAll('.role-card').forEach(card => {
        const cardLevel = parseInt(card.dataset.level);
        if (cardLevel === level) {
        card.classList.add('selected');
        } else {
        card.classList.remove('selected');
        }
        });
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —à–∞–≥–∞–º
        function goToStep(step) {
        if (step < 1 || step > 3) return;

        // –°–∫—Ä—ã—Ç—å —Ç–µ–∫—É—â–∏–π —à–∞–≥
        document.querySelector(`#step-${currentStep}`).classList.remove('active');
        document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');

        // –ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π —à–∞–≥
        currentStep = step;
        document.querySelector(`#step-${currentStep}`).classList.add('active');
        document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');

        // –û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —à–∞–≥–∏ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ
        document.querySelectorAll('.step').forEach(stepEl => {
        const stepNum = parseInt(stepEl.dataset.step);
        if (stepNum < currentStep) {
        stepEl.classList.add('completed');
        } else if (stepNum > currentStep) {
        stepEl.classList.remove('completed');
        }
        });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        async function loadCurrentSettings() {
        try {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É
        const folderResult = await makeRequest('/api/downloader/settings/folder', 'GET');
        if (folderResult.success && folderResult.data) {
        if (folderResult.data.Path && folderResult.data.Path !== "not setted") {
        document.getElementById('folder-path').value = folderResult.data.Path;
        }
        }
        } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫:', error);
        }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        async function saveDirectorySettings() {
        const path = document.getElementById('folder-path').value.trim();
        if (!path) {
        showToast('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ', 'warning');
        return;
        }

        try {
        const result = await makeRequest('/api/downloader/settings/folder', 'PUT', { Path: path });

        if (result.success) {
        showToast('–ü—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
        goToStep(2);
        } else {
        showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —á–∞—Ç—É
        async function connectToChat() {
        const room = document.getElementById('chat-room').value.trim();
        if (!room) {
        showToast('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞', 'warning');
        return;
        }

        const btn = document.getElementById('connect-btn');
        btn.innerHTML = '<span class="loading"></span> –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...';
        btn.disabled = true;

        try {
        const result = await makeRequest('/api/irc_client/join', 'POST', {
        Channel: room
        });

        if (result.success) {
        showToast(`–£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ –∫–∞–Ω–∞–ª—É: ${room}`, 'success');
        goToStep(3);
        } else {
        showToast('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }

        btn.innerHTML = '<span>üîó</span> –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è';
        btn.disabled = false;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
        async function allowUser() {
        const username = document.getElementById('allow-user').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        try {
        const result = await makeRequest('/api/white_list/users', 'PUT', {
        UserName: username
        });

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫`, 'success');
        document.getElementById('allow-user').value = '';
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function removeAllowedUser() {
        const username = document.getElementById('allow-user').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        try {
        const result = await makeRequest('/api/white_list/users', 'DELETE', {
        UserName: username
        });

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —É–¥–∞–ª–µ–Ω –∏–∑ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞`, 'success');
        document.getElementById('allow-user').value = '';
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function blockUser() {
        const username = document.getElementById('block-user').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        try {
        const result = await makeRequest('/api/black_list/users', 'PUT', {
        UserName: username
        });

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`, 'success');
        document.getElementById('block-user').value = '';
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function removeBlockedUser() {
        const username = document.getElementById('block-user').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        try {
        const result = await makeRequest('/api/black_list/users', 'DELETE', {
        UserName: username
        });

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`, 'success');
        document.getElementById('block-user').value = '';
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        async function saveAllSettings() {
        const trustedOnly = document.getElementById('trusted-only').value === 'true';

        try {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞
        const levelResult = await makeRequest('/api/validator/settings/role_filter_level', 'PUT', {
        RoleFilterLevel: selectedRoleLevel
        });

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∂–∏–º –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - FIXED: uses whitelist_only with Enabled field
        const trustedResult = await makeRequest('/api/validator/settings/whitelist_only', 'PUT', {
        Enabled: trustedOnly
        });

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        const saveResult = await makeRequest('/api/settings/save', 'POST');

        if (levelResult.success && trustedResult.success && saveResult.success) {
        showToast('–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–µ–∫
        setTimeout(() => {
        window.location.href = 'index.html';
        }, 1500);
        } else {
        showToast('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫', 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞: ' + error.message, 'error');
        }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ
        async function loadAndContinue() {
        try {
        const result = await makeRequest('/api/settings/load', 'POST');

        if (result.success) {
        showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
        // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–µ–∫
        setTimeout(() => {
        window.location.href = 'index.html';
        }, 1000);
        } else {
        showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ' + result.message, 'error');
        }
        } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –≤ loadAndContinue:', error);
        showToast('–û—à–∏–±–∫–∞: ' + error.message, 'error');
        }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
async function makeRequest(endpoint, method, data = null) {
    const url = SERVER_URL + endpoint;

    try {
        const options = {
            method: method,
            headers: {
                'Content-Type': 'application/json'
            }
        };

        if (method !== 'GET' && data !== null) {
            options.body = JSON.stringify(data);
        }

        const response = await fetch(url, options);
        let resultData;
        
        // –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –∫–∞–∫ ArrayBuffer –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–∏—Ç–æ–≥–æ UTF-8
        const buffer = await response.arrayBuffer();
        
        // –ü—ã—Ç–∞–µ–º—Å—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫ UTF-8
        const decoder = new TextDecoder('utf-8', { fatal: false });
        const text = decoder.decode(buffer);
        
        // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ JSON
        try {
            resultData = JSON.parse(text);
        } catch (jsonError) {
            // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ JSON, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–µ–∫—Å—Ç
            console.warn(`JSON parse failed for ${endpoint}:`, jsonError, 'Text:', text.substring(0, 100));
            resultData = text;
        }

        return {
            success: response.ok,
            message: resultData,
            data: response.ok ? resultData : null,
            status: response.status
        };
    } catch (error) {
        console.error('Request error:', error);
        return {
            success: false,
            message: '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + error.message,
            data: null
        };
    }
}


        // Toast notification
        function showToast(message, type = 'info') {
        // Remove existing toasts
        document.querySelectorAll('.toast').forEach(toast => toast.remove());

        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;
        toast.innerHTML = `
        <span>${message}</span>
        <button onclick="this.parentElement.remove()">√ó</button>
        `;

        document.body.appendChild(toast);

        // Auto remove after 5 seconds
        setTimeout(() => {
        if (toast.parentElement) {
        toast.remove();
        }
        }, 5000);
        }
    </script>
</body>
</html>