<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RequestFlow</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="icon" type="image/png" href="./favicon.png">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="icon" type="image/png" href="http://localhost:23140/favicon.png">
    <style>
        :root {
            --bg-dark: #0a0a12;
            --bg-card: #11111a;
            --bg-hover: #1a1a24;
            --border: #2a2a3a;
            --text: #e0e0ff;
            --text-light: #a0a0c0;
            --purple: #9d4edd;
            --purple-light: #c77dff;
            --neon-purple: #e0aaff;
            --cyan: #00e5ff;
            --neon-cyan: #80ffea;
            --green: #00ff9d;
            --yellow: #ffd166;
            --orange: #ff7b00;
            --neon-orange: #ff9e00;
            --red: #ff3860;
            --glow: 0 0 20px rgba(157, 78, 221, 0.3);
            --glow-strong: 0 0 30px rgba(157, 78, 221, 0.5);
            --glow-orange: 0 0 15px rgba(255, 123, 0, 0.4);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --radius: 16px;
            --radius-sm: 8px;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a0b2e 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: rgba(17, 17, 26, 0.9);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border);
            padding: 30px 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            box-shadow: 5px 0 40px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 30px;
            padding: 18px;
            background: rgba(255, 123, 0, 0.05);
            border: 2px solid rgba(255, 123, 0, 0.3);
            border-radius: var(--radius);
            position: relative;
            overflow: hidden;
            text-align: center;
            flex-wrap: nowrap;
            min-width: 0;
        }

            .logo::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 3px;
                background: linear-gradient(90deg, var(--orange), var(--neon-orange));
                box-shadow: var(--glow-orange);
            }

        .logo-text {
            font-size: 1.6rem;
            font-weight: 800;
            letter-spacing: 0.5px;
            background: linear-gradient(45deg, var(--neon-orange), var(--purple-light));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 15px rgba(255, 123, 0, 0.4);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            text-align: center;
            max-width: calc(100% - 40px);
        }

        .nav-section {
            margin-bottom: 25px;
            min-width: 0;
        }

        .nav-title {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-light);
            margin-bottom: 12px;
            padding-left: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 18px;
            margin: 5px 0;
            background: transparent;
            border: 2px solid transparent;
            border-radius: var(--radius-sm);
            color: var(--text-light);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            white-space: nowrap;
            min-width: 0;
        }

            .nav-item:hover {
                background: rgba(255, 123, 0, 0.1);
                border-color: rgba(255, 123, 0, 0.3);
                color: var(--text);
                transform: translateX(6px);
            }

            .nav-item.active {
                background: linear-gradient(135deg, rgba(157, 78, 221, 0.2), rgba(255, 123, 0, 0.1));
                border-color: var(--orange);
                color: var(--text);
                box-shadow: var(--glow-orange);
            }

                .nav-item.active::before {
                    content: '';
                    position: absolute;
                    left: 0;
                    top: 0;
                    height: 100%;
                    width: 4px;
                    background: var(--neon-orange);
                    box-shadow: 0 0 10px var(--orange);
                }

        .nav-icon {
            font-size: 1.3rem;
            width: 22px;
            text-align: center;
            flex-shrink: 0;
            min-width: 22px;
        }

        .nav-text {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        .save-all-container {
            margin-top: auto;
            margin-bottom: 20px;
        }

        .save-all-btn {
            width: 100%;
            padding: 14px 18px;
            background: linear-gradient(135deg, var(--orange), #ff5e00);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
        }

            .save-all-btn:hover {
                transform: translateY(-3px);
                box-shadow: var(--glow-orange);
                background: linear-gradient(135deg, var(--neon-orange), var(--orange));
            }

            .save-all-btn.saved {
                background: linear-gradient(135deg, var(--green), #00cc88);
                cursor: default;
            }

                .save-all-btn.saved:hover {
                    transform: none;
                    box-shadow: none;
                    background: linear-gradient(135deg, var(--green), #00cc88);
                }

            .save-all-btn:disabled {
                background: rgba(255, 255, 255, 0.05);
                border: 2px solid var(--border);
                color: var(--text-light);
                cursor: not-allowed;
                opacity: 0.6;
            }

                .save-all-btn:disabled:hover {
                    transform: none;
                    box-shadow: none;
                    background: rgba(255, 255, 255, 0.05);
                }

        .main-content {
            margin-left: 280px;
            padding: 40px;
            min-height: 100vh;
        }

        .page-header {
            text-align: center;
            margin-bottom: 50px;
            position: relative;
        }

        .page-title {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(45deg, var(--orange), var(--purple), var(--cyan));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 5px 20px rgba(157, 78, 221, 0.3);
            animation: gradientShift 8s ease infinite;
            background-size: 200% 200%;
            position: relative;
            padding-bottom: 15px;
        }

            .page-title::after {
                content: '';
                position: absolute;
                bottom: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 200px;
                height: 3px;
                background: linear-gradient(90deg, transparent, var(--neon-orange), transparent);
                box-shadow: 0 0 10px var(--orange);
            }

        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .content-section {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

            .content-section.active {
                display: block;
            }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background: linear-gradient(135deg, var(--bg-card) 0%, #13131d 100%);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 30px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            height: 100%;
        }

            .card:hover {
                border-color: var(--orange);
                box-shadow: var(--glow-orange);
                transform: translateY(-5px);
            }

            .card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 3px;
                background: linear-gradient(90deg, var(--orange), var(--purple));
                border-radius: var(--radius) var(--radius) 0 0;
                box-shadow: 0 0 10px var(--orange);
            }

        .card-header {
            display: flex;
            align-items: center;
            gap: 18px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .card-icon {
            font-size: 2.5rem;
            background: linear-gradient(45deg, var(--orange), var(--purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(255, 123, 0, 0.3);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: calc(100% - 60px);
        }

        .card-content {
            margin-bottom: 25px;
        }

        .status-display {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 20px;
            margin: 15px 0;
        }

        .status-value {
            font-size: 1.2rem;
            color: var(--text);
            font-family: 'Monaco', 'Menlo', monospace;
            word-break: break-all;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-sm);
        }

        .status-empty {
            color: var(--text-light);
            font-style: italic;
            text-align: center;
            padding: 20px;
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-label {
            display: block;
            margin-bottom: 10px;
            color: var(--text);
            font-weight: 600;
            font-size: 1rem;
        }

        .control-input {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            font-size: 1rem;
            transition: var(--transition);
            font-family: 'Segoe UI', sans-serif;
        }

            .control-input:focus {
                outline: none;
                border-color: var(--orange);
                box-shadow: 0 0 0 3px rgba(255, 123, 0, 0.1);
                background: rgba(255, 123, 0, 0.05);
            }

            .control-input::placeholder {
                color: var(--text-light);
                opacity: 0.5;
            }

        #new-channel::placeholder {
            color: rgba(224, 224, 255, 0.3);
            font-style: italic;
        }

        .path-editable {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .path-input {
            flex: 1;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            font-size: 1rem;
            font-family: 'Monaco', 'Menlo', monospace;
            min-width: 0;
        }

            .path-input:focus {
                outline: none;
                border-color: var(--orange);
                box-shadow: 0 0 0 3px rgba(255, 123, 0, 0.1);
            }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 16px 24px;
            background: linear-gradient(135deg, var(--orange), #ff5e00);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-height: 52px;
            white-space: nowrap;
            min-width: 0;
        }

            .btn:hover {
                transform: translateY(-3px);
                box-shadow: var(--glow-orange);
                background: linear-gradient(135deg, var(--neon-orange), var(--orange));
                color: white;
            }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border);
            color: var(--text);
        }

            .btn-secondary:hover {
                border-color: var(--orange);
                background: rgba(255, 123, 0, 0.1);
                color: var(--text);
            }

        .btn-danger {
            background: linear-gradient(135deg, var(--red), #c2185b);
            color: white;
        }

            .btn-danger:hover {
                background: linear-gradient(135deg, #ff5252, var(--red));
                box-shadow: 0 0 20px rgba(255, 56, 96, 0.3);
            }

        .btn-success {
            background: linear-gradient(135deg, var(--green), #00cc88);
            color: white;
        }

            .btn-success:hover {
                background: linear-gradient(135deg, #00ff9d, var(--green));
                box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
            }

        .btn-warning {
            background: linear-gradient(135deg, var(--neon-orange), #ff9800);
            color: #222;
            font-weight: 700;
        }

            .btn-warning:hover {
                background: linear-gradient(135deg, #ffb347, var(--neon-orange));
                box-shadow: 0 0 20px rgba(255, 158, 0, 0.3);
                color: #222;
            }

        .btn-disabled {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border);
            color: var(--text-light);
            cursor: not-allowed;
            opacity: 0.6;
        }

            .btn-disabled:hover {
                transform: none;
                box-shadow: none;
                background: rgba(255, 255, 255, 0.05);
            }

        .icon-btn {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 123, 0, 0.1);
            border: 2px solid var(--orange);
            border-radius: var(--radius-sm);
            color: var(--neon-orange);
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.3rem;
            flex-shrink: 0;
        }

            .icon-btn:hover {
                background: var(--orange);
                color: white;
                box-shadow: var(--glow-orange);
                transform: scale(1.05);
            }

        .server-status {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 25px;
            margin: 20px 0;
            position: relative;
        }

            .server-status::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                border: 1px solid transparent;
                border-radius: var(--radius-sm);
                background: linear-gradient(45deg, var(--orange), var(--purple)) border-box;
                -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
                -webkit-mask-composite: destination-out;
                mask-composite: exclude;
                pointer-events: none;
            }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 20px;
            border: 2px solid transparent;
            color: white;
            white-space: nowrap;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            min-height: 42px;
            box-sizing: border-box;
            line-height: 1.3;
        }

            .status-badge.waiting {
                background: rgba(255, 209, 102, 0.1);
                border-color: var(--yellow);
                color: var(--yellow);
            }

            .status-badge.ready {
                background: rgba(0, 255, 157, 0.1);
                border-color: var(--green);
                color: var(--green);
            }

            .status-badge.error {
                background: rgba(255, 123, 0, 0.1);
                border-color: var(--orange);
                color: var(--neon-orange);
            }

            .status-badge.fatal {
                background: rgba(255, 56, 96, 0.1);
                border-color: var(--red);
                color: var(--red);
                animation: pulse 2s infinite;
            }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .server-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .info-item {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 15px;
        }

        .info-label {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .info-value {
            font-size: 1.1rem;
            color: var(--text);
            font-weight: 600;
            word-break: break-all;
        }

        .settings-form {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 30px;
            margin: 25px 0;
            position: relative;
        }

            .settings-form::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 2px;
                background: linear-gradient(90deg, var(--orange), transparent);
            }

        .form-title {
            font-size: 1.4rem;
            color: var(--text);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            flex: 1;
            min-width: 0;
        }

        .file-size-section {
            margin-bottom: 40px;
        }

        .file-size-form {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 25px;
            margin-top: 20px;
            position: relative;
        }

            .file-size-form::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 2px;
                background: linear-gradient(90deg, var(--orange), transparent);
            }

        .logs-console {
            background: rgba(10, 10, 18, 0.9);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 600px;
        }

        .logs-header {
            padding: 20px;
            background: rgba(17, 17, 26, 0.8);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logs-title {
            font-size: 1.5rem;
            color: var(--text);
            font-weight: 700;
        }

        .logs-controls {
            display: flex;
            gap: 10px;
        }

        .logs-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .log-entry {
            margin-bottom: 12px;
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            background: rgba(255, 255, 255, 0.02);
            border-left: 4px solid var(--border);
            animation: slideInRight 0.3s ease;
        }

            .log-entry.request {
                border-left-color: var(--purple);
            }

            .log-entry.response {
                border-left-color: var(--green);
            }

            .log-entry.error {
                border-left-color: var(--red);
            }

            .log-entry.warning {
                border-left-color: var(--orange);
            }

        .log-time {
            color: var(--text-light);
            font-size: 0.8rem;
            margin-right: 10px;
        }

        .log-method {
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            margin-right: 8px;
            color: white;
            white-space: nowrap;
        }

            .log-method.get {
                background: rgba(0, 229, 255, 0.2);
                color: var(--cyan);
            }

            .log-method.post {
                background: rgba(157, 78, 221, 0.2);
                color: var(--purple-light);
            }

            .log-method.put {
                background: rgba(255, 123, 0, 0.2);
                color: var(--neon-orange);
            }

            .log-method.delete {
                background: rgba(255, 56, 96, 0.2);
                color: var(--red);
            }

        .quick-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .quick-btn {
            padding: 18px 36px;
            background: linear-gradient(135deg, rgba(255, 123, 0, 0.2), rgba(0, 229, 255, 0.2));
            border: 2px solid rgba(255, 123, 0, 0.3);
            border-radius: var(--radius);
            color: var(--text);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }

            .quick-btn:hover {
                background: linear-gradient(135deg, rgba(255, 123, 0, 0.3), rgba(0, 229, 255, 0.3));
                border-color: var(--orange);
                box-shadow: var(--glow-orange);
                transform: translateY(-5px);
            }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

            .modal.active {
                display: flex;
            }

        .modal-content {
            background: var(--bg-card);
            border: 2px solid var(--orange);
            border-radius: var(--radius);
            padding: 30px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: var(--glow-orange);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: var(--text);
            font-size: 2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

            .modal-close:hover {
                background: rgba(255, 123, 0, 0.1);
                color: var(--orange);
            }

        .modal-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--text);
            text-align: center;
        }

        .user-lists-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .user-list-box {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 20px;
        }

        .user-list-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }

        .user-list-items {
            min-height: 100px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-sm);
        }

        .user-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 5px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
        }

        .user-list-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .loading {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--orange);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 1200px) {
            .sidebar {
                width: 240px;
            }

            .main-content {
                margin-left: 240px;
                padding: 30px;
            }

            .logo-text {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                padding: 20px;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                flex-direction: column;
            }

            .quick-actions {
                flex-direction: column;
            }

            .action-buttons {
                flex-direction: column;
            }

            .user-lists-container {
                grid-template-columns: 1fr;
            }

            .page-title {
                font-size: 2.8rem;
            }

            .save-all-container {
                margin-top: 30px;
                margin-bottom: 0;
            }

            .logo-text {
                font-size: 1.6rem;
            }

            .status-badge {
                font-size: 0.9rem;
                padding: 8px 14px;
                min-height: 38px;
            }
        }

        @media (max-width: 480px) {
            .page-title {
                font-size: 2.2rem;
            }

            .card {
                padding: 20px;
            }

            .modal-content {
                padding: 30px 20px;
            }

            .logo-text {
                font-size: 1.4rem;
            }

            .status-badge {
                font-size: 0.85rem;
                padding: 7px 12px;
                min-height: 36px;
                gap: 8px;
            }

            .btn {
                padding: 14px 20px;
                font-size: 0.95rem;
            }
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: var(--radius-sm);
            color: white;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            min-width: 300px;
            max-width: 400px;
            z-index: 9999;
            animation: slideInRight 0.3s ease, fadeOut 0.3s ease 4.7s;
            animation-fill-mode: forwards;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .toast-success {
            background: linear-gradient(135deg, var(--green), #00cc88);
            border-left: 4px solid var(--green);
        }

        .toast-error {
            background: linear-gradient(135deg, var(--red), #c2185b);
            border-left: 4px solid var(--red);
        }

        .toast-warning {
            background: linear-gradient(135deg, var(--orange), #ff9800);
            border-left: 4px solid var(--orange);
        }

        .toast-info {
            background: linear-gradient(135deg, var(--purple), #7b2cbf);
            border-left: 4px solid var(--purple);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div class="sidebar">
        <div class="logo">
            <span class="logo-text">RequestFlow</span>
        </div>

        <div class="nav-section">
            <div class="nav-title">–û—Å–Ω–æ–≤–Ω—ã–µ</div>
            <div class="nav-item active" data-section="dashboard">
                <span class="nav-icon">üè†</span>
                <span class="nav-text">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</span>
            </div>
            <div class="nav-item" data-section="directory">
                <span class="nav-icon">üìÇ</span>
                <span class="nav-text">–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è</span>
            </div>
            <div class="nav-item" data-section="chat-management">
                <span class="nav-icon">üí¨</span>
                <span class="nav-text">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º</span>
            </div>
        </div>

        <div class="nav-section">
            <div class="nav-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div class="nav-item" data-section="downloader">
                <span class="nav-icon">üì•</span>
                <span class="nav-text">–ó–∞–≥—Ä—É–∑—á–∏–∫</span>
            </div>
            <div class="nav-item" data-section="users">
                <span class="nav-icon">üë•</span>
                <span class="nav-text">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
            </div>
        </div>

        <div class="nav-section">
            <div class="nav-title">–û—Ç–ª–∞–¥–∫–∞</div>
            <div class="nav-item" data-section="logs">
                <span class="nav-icon">üìã</span>
                <span class="nav-text">–õ–æ–≥–∏</span>
            </div>
            <div class="nav-item" data-section="feedback">
                <span class="nav-icon">üí≠</span>
                <span class="nav-text">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</span>
            </div>
        </div>

        <div class="save-all-container">
            <button class="save-all-btn" id="save-all-btn" onclick="saveAllSettings()" disabled>
                <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            </button>
        </div>
    </div>

    <div class="main-content">
        <div class="content-section active" id="dashboard-section">
            <div class="page-header">
                <h1 class="page-title">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">üìÇ</span>
                        <span class="card-title">–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–∫–∏</span>
                    </div>
                    <div class="card-content">
                        <div class="status-display">
                            <div class="status-value" id="current-folder">
                                <span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞...
                            </div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn" onclick="navigateToSection('directory')">
                            <span>‚öôÔ∏è</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">üí¨</span>
                        <span class="card-title">–ß—Ç–µ–Ω–∏–µ —á–∞—Ç–∞</span>
                    </div>
                    <div class="card-content">
                        <div id="chat-channels" class="status-display">
                            <span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–Ω–∞–ª–æ–≤...
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn" onclick="navigateToSection('chat-management')">
                            <span>‚öôÔ∏è</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">üöÄ</span>
                        <span class="card-title">–°–µ—Ä–≤–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏</span>
                    </div>
                    <div class="card-content">
                        <div class="server-status">
                            <div class="status-badge waiting" id="server-status-badge">
                                <span class="loading"></span> –ü—Ä–æ–≤–µ—Ä–∫–∞...
                            </div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn" onclick="startAvailabilityCheck()" id="check-availability-btn">
                            <span>üìä</span> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
                        </button>
                    </div>
                </div>
            </div>

            <div class="quick-actions">
                <button class="quick-btn" onclick="loadSettings()">
                    <span>üìÇ</span>
                    <span>–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </button>
                <button class="quick-btn" onclick="saveSettings()">
                    <span>üíæ</span>
                    <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </button>
                <button class="quick-btn" onclick="checkAllStatuses()">
                    <span>üîÑ</span>
                    <span>–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</span>
                </button>
            </div>
        </div>

        <div class="content-section" id="directory-section">
            <div class="page-header">
                <h1 class="page-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π</h1>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üìÇ</span>
                    <span class="card-title">–¢–µ–∫—É—â–∏–π –ø—É—Ç—å</span>
                </div>
                <div class="card-content">
                    <div class="path-editable">
                        <input type="text" class="path-input" id="folder-path-input"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ Songs...">
                        <button class="icon-btn" onclick="saveFolderPath()" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">
                            üíæ
                        </button>
                    </div>
                    <p style="color: var(--text-light); margin: 15px 0; font-size: 0.95rem;">
                        –ü—Ä–∏–º–µ—Ä: <code>C:\Games\osu!\Songs</code> –∏–ª–∏ <code>D:\osu!\Songs</code>
                    </p>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="pickFolderWithExplorer()">
                        <span>üìÅ</span> –í—ã–±—Ä–∞—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫
                    </button>
                    <button class="btn-secondary" onclick="loadCurrentFolder()">
                        <span>üîÑ</span> –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>

        <div class="content-section" id="chat-management-section">
            <div class="page-header">
                <h1 class="page-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º</h1>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üí¨</span>
                    <span class="card-title">–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã</span>
                </div>
                <div class="card-content">
                    <div id="chat-channels-list" class="status-display">
                        <span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–Ω–∞–ª–æ–≤...
                    </div>
                    <div class="control-group" style="margin-top: 30px;">
                        <label class="control-label">–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –Ω–æ–≤–æ–º—É –∫–∞–Ω–∞–ª—É</label>
                        <input type="text" class="control-input" id="new-channel"
                               placeholder="myangelwhitecat" style="opacity: 0.6;">
                        <p style="color: var(--text-light); font-size: 0.9rem; margin-top: 8px;">
                            –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ Twitch –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                        </p>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="joinChannel()">
                        <span>‚ûï</span> –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
                    </button>
                    <button class="btn-secondary" onclick="refreshChannels()">
                        <span>üîÑ</span> –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                    </button>
                </div>
            </div>
        </div>

        <div class="content-section" id="downloader-section">
            <div class="page-header">
                <h1 class="page-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞</h1>
            </div>

            <div class="file-size-section">
                <h2 class="form-title">–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞</h2>
                <div class="file-size-form">
                    <div class="form-group">
                        <label class="control-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (MB)</label>
                        <input type="number" class="control-input" id="max-file-size"
                               value="100" min="50" max="1024">
                        <p style="color: var(--text-light); font-size: 0.9rem; margin-top: 8px;">
                            –î–∏–∞–ø–∞–∑–æ–Ω: 50-1024 MB. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 350 MB
                        </p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-success" onclick="saveFileSizeSettings()">
                            <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
                        </button>
                        <button class="btn-secondary" onclick="loadFileSizeSettings()">
                            <span>üì•</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–π
                        </button>
                    </div>
                </div>
            </div>

            <div class="settings-form">
                <h3 class="form-title">–†–µ—Å—É—Ä—Å –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="control-label">–°–µ—Ä–≤–µ—Ä</label>
                        <input type="text" class="control-input" id="download-server"
                               placeholder="catboy.best">
                    </div>
                    <div class="form-group">
                        <label class="control-label">–ü—Ä–µ—Ñ–∏–∫—Å –ø—É—Ç–∏</label>
                        <input type="text" class="control-input" id="download-prefix"
                               placeholder="/d/">
                    </div>
                </div>
                <div style="margin-top: 20px; color: var(--text-light); font-size: 0.9rem;">
                    <p>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã:</p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>catboy.best ‚Äî /d/</li>
                        <li>osu.direct ‚Äî /api/d/</li>
                        <li>nerinyan.moe ‚Äî /d/</li>
                    </ul>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="saveServerSettings()">
                        <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–µ—Ñ–∏–∫—Å
                    </button>
                    <button class="btn-secondary" onclick="loadServerSettings()">
                        <span>üì•</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–µ
                    </button>
                </div>
            </div>
        </div>

        <div class="content-section" id="users-section">
            <div class="page-header">
                <h1 class="page-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h1>
            </div>

            <div class="settings-form">
                <h3 class="form-title">–£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞</h3>
                <div class="control-group">
                    <label class="control-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞</label>
                    <select class="control-input" id="role-level">
                        <option value="0">0 - –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                        <option value="1">1 - –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ –∏ –≤—ã—à–µ</option>
                        <option value="2" selected>2 - VIP –∏ –≤—ã—à–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                        <option value="3">3 - –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Å—Ç—Ä–∏–º–µ—Ä</option>
                        <option value="4">4 - –¢–æ–ª—å–∫–æ —Å—Ç—Ä–∏–º–µ—Ä</option>
                    </select>
                </div>
                <div class="control-group">
                    <label class="control-label">–†–µ–∂–∏–º –¥–æ—Å—Ç—É–ø–∞</label>
                    <select class="control-input" id="access-mode">
                        <option value="false">–î–æ—Å—Ç—É–ø –ø–æ —Ä–æ–ª—è–º</option>
                        <option value="true">–¢–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                    </select>
                </div>
            </div>

            <div class="settings-form">
                <h3 class="form-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>

                <div class="user-lists-container">
                    <div class="user-list-box">
                        <div class="user-list-title">–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                        <div class="user-list-items" id="whitelist-items">
                            <span class="status-empty">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                    </div>
                    <div class="user-list-box">
                        <div class="user-list-title">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                        <div class="user-list-items" id="blacklist-items">
                            <span class="status-empty">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                    </div>
                </div>

                <div class="form-row" style="margin-top: 25px;">
                    <div class="form-group">
                        <label class="control-label">–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</label>
                        <input type="text" class="control-input" id="allow-user-input"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ username...">
                        <div class="user-list-actions">
                            <button class="btn btn-success" onclick="addToWhitelist()">
                                <span>‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å
                            </button>
                            <button class="btn btn-danger" onclick="removeFromWhitelist()">
                                <span>üóëÔ∏è</span> –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</label>
                        <input type="text" class="control-input" id="block-user-input"
                               placeholder="–í–≤–µ–¥–∏—Ç–µ username...">
                        <div class="user-list-actions">
                            <button class="btn btn-danger" onclick="addToBlacklist()">
                                <span>‚õî</span> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button class="btn btn-success" onclick="removeFromBlacklist()">
                                <span>‚úÖ</span> –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 25px;">
                    <button class="btn btn-warning" onclick="saveUserSettings()" style="width: 100%;">
                        <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    </button>
                </div>
            </div>
        </div>

        <div class="content-section" id="logs-section">
            <div class="page-header">
                <h1 class="page-title">–ö–æ–Ω—Å–æ–ª—å –ª–æ–≥–æ–≤</h1>
            </div>

            <div class="logs-console">
                <div class="logs-header">
                    <h3 class="logs-title">–ñ—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π</h3>
                    <div class="logs-controls">
                        <button class="btn btn-danger" onclick="clearLogs()">
                            <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                        <button class="btn-secondary" onclick="toggleAutoScroll()" id="auto-scroll-btn">
                            <span>üìú</span> –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞: –í–∫–ª
                        </button>
                        <button class="btn btn-success" onclick="exportLogs()">
                            <span>üíæ</span> –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                    </div>
                </div>
                <div class="logs-content" id="logs-content">
                    <div class="log-entry">
                        <span class="log-time">[00:00:00]</span>
                        <span>–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section" id="feedback-section">
            <div class="page-header">
                <h1 class="page-title">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</h1>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üí≠</span>
                    <span class="card-title">–û—Ç–∑—ã–≤—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</span>
                </div>
                <div class="card-content">
                    <p style="color: var(--text-light); margin-bottom: 20px; line-height: 1.6;">
                        –ï—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ –æ—à–∏–±–∫—É –≤ —Ä–∞–±–æ—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é,
                        –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–∑–¥–∞–π—Ç–µ issue –Ω–∞ GitHub –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.
                    </p>
                    <ul style="color: var(--text-light); margin-left: 20px; line-height: 1.8;">
                        <li>–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ –≤ —Ä–∞–±–æ—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã</li>
                        <li>–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</li>
                        <li>–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</li>
                        <li>–°–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</li>
                    </ul>
                </div>
                <div class="action-buttons">
                    <button class="btn" onclick="window.open('https://github.com/MyAngelWhiteCat/OsuRequestFlow/issues/new', '_blank')">
                        <span>üìù</span> –°–æ–∑–¥–∞—Ç—å Issue –Ω–∞ GitHub
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="channel-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeChannelModal()">√ó</button>
            <h3 class="modal-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞–º–∏</h3>

            <div class="control-group">
                <label class="control-label">–ù–æ–≤—ã–π –∫–∞–Ω–∞–ª</label>
                <input type="text" class="control-input" id="modal-channel-input"
                       placeholder="myangelwhitecat" style="opacity: 0.6;">
            </div>

            <div id="modal-channels-list" style="margin: 25px 0; max-height: 300px; overflow-y: auto;">

            </div>

            <div class="action-buttons">
                <button class="btn btn-success" onclick="joinChannelFromModal()">
                    <span>‚ûï</span> –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
                </button>
                <button class="btn-secondary" onclick="closeChannelModal()">
                    <span>‚úñÔ∏è</span> –ó–∞–∫—Ä—ã—Ç—å
                </button>
            </div>
        </div>
    </div>

    <script>
        const SERVER_URL = 'http://127.0.0.1:23140';
        let serverCheckInterval = null;
        let logs = [];
        let autoScroll = true;
        let isServerCheckActive = true;
        let isCheckActive = false;
        let checkStartTime = null;
        let longCheckNotificationShown = false;

        let hasUnsavedChanges = false;
        let originalSettings = {};

        function initParticles() {
        const particles = document.getElementById('particles');
        for (let i = 0; i < 50; i++) {
        const particle = document.createElement('div');
        particle.style.cssText = `
        position: absolute;
        width: 2px;
        height: 2px;
        background: linear-gradient(45deg, var(--orange), var(--purple));
        border-radius: 50%;
        animation: float ${3 + Math.random() * 4}s ease-in-out infinite;
        animation-delay: ${Math.random() * 5}s;
        `;
        particle.style.left = `${Math.random() * 100}%`;
        particle.style.top = `${Math.random() * 100}%`;
        particles.appendChild(particle);
        }

        const style = document.createElement('style');
        style.textContent = `
        @keyframes float {
        0%, 100% { transform: translate(0, 0); opacity: 0.3; }
        50% { transform: translate(${Math.random() * 100 - 50}px, ${Math.random() * 100 - 50}px); opacity: 0.8; }
        }
        `;
        document.head.appendChild(style);
        }

        function updateSaveButtonState() {
        const saveBtn = document.getElementById('save-all-btn');

        if (hasUnsavedChanges) {
        saveBtn.disabled = false;
        saveBtn.classList.remove('saved');
        saveBtn.innerHTML = '<span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏';
        saveBtn.title = '–ï—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è';
        } else {
        saveBtn.disabled = true;
        saveBtn.classList.add('saved');
        saveBtn.innerHTML = '<span>‚úÖ</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã';
        saveBtn.title = '–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã';
        }
        }

        function markSettingsChanged() {
        hasUnsavedChanges = true;
        updateSaveButtonState();
        }

        function markSettingsSaved() {
        hasUnsavedChanges = false;
        updateSaveButtonState();
        }

        function navigateToSection(section) {
        document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.section === section) {
        item.classList.add('active');
        }
        });

        document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
        });

        document.getElementById(`${section}-section`).classList.add('active');

        switch(section) {
        case 'directory':
        loadCurrentFolder();
        break;
        case 'chat-management':
        loadChatChannelsList();
        break;
        case 'downloader':
        loadFileSizeSettings();
        loadServerSettings();
        break;
        case 'users':
        loadUserSettings();
        loadUserLists();
        break;
        case 'logs':
        updateLogsDisplay();
        break;
        }
        }

        function addLog(type, method, endpoint, data = null) {
        const timestamp = new Date().toLocaleTimeString();
        const logEntry = {
        id: Date.now(),
        type,
        timestamp,
        method,
        endpoint,
        data: data ? JSON.stringify(data, null, 2) : null
        };

        logs.unshift(logEntry);
        if (logs.length > 100) logs = logs.slice(0, 100);
        updateLogsDisplay();
        }

        function updateLogsDisplay() {
        const container = document.getElementById('logs-content');
        container.innerHTML = '';

        logs.forEach(log => {
        const div = document.createElement('div');
        div.className = `log-entry ${log.type}`;
        div.innerHTML = `
        <span class="log-time">[${log.timestamp}]</span>
        <span class="log-method ${log.method.toLowerCase()}">${log.method}</span>
        <span class="log-endpoint">${log.endpoint}</span>
        ${log.data ? `<div style="margin-top: 5px; color: var(--text-light); font-size: 0.85rem; font-family: monospace; white-space: pre-wrap;">${log.data}</div>` : ''}
        `;
        container.appendChild(div);
        });

        if (autoScroll && container.firstChild) {
        container.scrollTop = 0;
        }
        }

        function clearLogs() {
        logs = [];
        updateLogsDisplay();
        addLog('response', 'INFO', '–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã');
        }

        function toggleAutoScroll() {
        autoScroll = !autoScroll;
        const btn = document.getElementById('auto-scroll-btn');
        btn.innerHTML = `<span>üìú</span> –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞: ${autoScroll ? '–í–∫–ª' : '–í—ã–∫–ª'}`;
        }

        function exportLogs() {
        const logText = logs.map(log =>
        `[${log.timestamp}] ${log.method} ${log.endpoint} ${log.data ? log.data : ''}`
        ).join('\n');

        const blob = new Blob([logText], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `requestflow_logs_${new Date().toISOString().slice(0, 10)}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        addLog('response', 'INFO', '–õ–æ–≥–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã');
        }

        async function loadCurrentFolder() {
        try {
        console.log('Loading current folder...');
        addLog('request', 'GET', '/api/downloader/settings/folder');
        const result = await makeRequest('/api/downloader/settings/folder', 'GET');
        addLog('response', 'GET', '/api/downloader/settings/folder', result.data);

        if (result.success) {
        const path = result.data?.Path || result.data?.path || "not setted";
        if (path === "not setted") {
        document.getElementById('current-folder').innerHTML =
        '<span style="color: var(--orange); font-style: italic;">–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞</span>';
        document.getElementById('folder-path-input').value = '';
        } else {
        document.getElementById('current-folder').textContent = path;
        document.getElementById('folder-path-input').value = path;
        }
        } else {
        document.getElementById('current-folder').innerHTML =
        `<span style="color: var(--red);">–û—à–∏–±–∫–∞: ${result.message}</span>`;
        }
        } catch (error) {
        console.error('Error loading folder:', error);
        addLog('error', 'GET', '/api/downloader/settings/folder', error.message);
        document.getElementById('current-folder').innerHTML =
        `<span style="color: var(--red);">–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</span>`;
        }
        }

        async function saveFolderPath() {
        const path = document.getElementById('folder-path-input').value.trim();
        if (!path) {
        alert('–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ');
        return;
        }

        try {
        addLog('request', 'PUT', '/api/downloader/settings/folder', { Path: path });
        const result = await makeRequest('/api/downloader/settings/folder', 'PUT', { Path: path });
        addLog('response', 'PUT', '/api/downloader/settings/folder', result);

        if (result.success) {
        document.getElementById('current-folder').textContent = path;
        showToast('–ü—É—Ç—å —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function pickFolderWithExplorer() {
        try {
        addLog('request', 'POST', '/api/downloader/settings/folder');
        const result = await makeRequest('/api/downloader/settings/folder', 'POST');
        addLog('response', 'POST', '/api/downloader/settings/folder', result);

        if (result.success) {
        showToast('–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É –≤ –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ', 'info');
        setTimeout(loadCurrentFolder, 1000);
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function loadChatChannelsList() {
        try {
        addLog('request', 'GET', '/api/irc_client/join');
        const result = await makeRequest('/api/irc_client/join', 'GET');
        addLog('response', 'GET', '/api/irc_client/join', result.data);

        const container = document.getElementById('chat-channels-list');
        const channelsContainer = document.getElementById('chat-channels');

        if (result.success && Array.isArray(result.data)) {
        const channels = result.data
        .filter(c => c && (c.Channel || c.channel))
        .map(c => c.Channel || c.channel);

        if (channels.length > 0) {
        let html = '';
        channels.forEach(channel => {
        html += `
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; margin-bottom: 8px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm); border-left: 3px solid var(--orange);">
        <span>${channel}</span>
        <button onclick="leaveChannel('${channel}')" style="padding: 6px 12px; background: rgba(255,56,96,0.1); color: var(--red); border: 1px solid var(--red); border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
        –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è
        </button>
        </div>
        `;
        });
        container.innerHTML = html;
        channelsContainer.innerHTML = channels.map(c =>
        `<div style="margin: 5px 0; padding: 8px; background: rgba(255,123,0,0.1); border-radius: 6px; border-left: 3px solid var(--orange);">${c}</div>`
        ).join('');
        } else {
        container.innerHTML = '<div class="status-empty">–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</div>';
        channelsContainer.innerHTML = '<span style="color: var(--text-light); font-style: italic;">–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</span>';
        }
        } else {
        container.innerHTML = '<div class="status-empty">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
        }
        } catch (error) {
        console.error('Error loading channels:', error);
        addLog('error', 'GET', '/api/irc_client/join', error.message);
        }
        }

        async function joinChannel() {
        const channel = document.getElementById('new-channel').value.trim();
        if (!channel) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞', 'warning');
        return;
        }

        try {
        addLog('request', 'POST', '/api/irc_client/join', { Channel: channel });
        const result = await makeRequest('/api/irc_client/join', 'POST', { Channel: channel });
        addLog('response', 'POST', '/api/irc_client/join', result);

        if (result.success) {
        showToast(`–ü–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ –∫–∞–Ω–∞–ª—É: ${channel}`, 'success');
        document.getElementById('new-channel').value = '';
        loadChatChannelsList();
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function leaveChannel(channel) {
        if (!confirm(`–û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç –∫–∞–Ω–∞–ª–∞ ${channel}?`)) return;

        try {
        addLog('request', 'POST', '/api/irc_client/part', { Channel: channel });
        const result = await makeRequest('/api/irc_client/part', 'POST', { Channel: channel });
        addLog('response', 'POST', '/api/irc_client/part', result);

        if (result.success) {
        showToast(`–û—Ç–∫–ª—é—á–∏–ª–∏—Å—å –æ—Ç –∫–∞–Ω–∞–ª–∞: ${channel}`, 'success');
        loadChatChannelsList();
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function loadFileSizeSettings() {
        try {
        addLog('request', 'GET', '/api/downloader/settings/max_file_size');
        const sizeResult = await makeRequest('/api/downloader/settings/max_file_size', 'GET');
        addLog('response', 'GET', '/api/downloader/settings/max_file_size', sizeResult.data);

        if (sizeResult.success && sizeResult.data) {
        const fileSize = sizeResult.data.FileSize || sizeResult.data.fileSize || 100;
        document.getElementById('max-file-size').value = fileSize;
        originalSettings.maxFileSize = fileSize;
        }
        } catch (error) {
        console.error('Error loading file size settings:', error);
        addLog('error', 'GET', '/api/downloader/settings/max_file_size', error.message);
        }
        }

        async function saveFileSizeSettings() {
        const size = parseInt(document.getElementById('max-file-size').value);

        if (isNaN(size) || size < 50 || size > 1024) {
        showToast('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 50 –¥–æ 1024 MB', 'warning');
        return;
        }

        try {
        addLog('request', 'PUT', '/api/downloader/settings/max_file_size', { FileSize: size });
        const result = await makeRequest('/api/downloader/settings/max_file_size', 'PUT', { FileSize: size });
        addLog('response', 'PUT', '/api/downloader/settings/max_file_size', result);

        if (result.success) {
        showToast('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
        originalSettings.maxFileSize = size;
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞', 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function loadServerSettings() {
        try {
        addLog('request', 'GET', '/api/downloader/settings/resource_and_prefix');
        const serverResult = await makeRequest('/api/downloader/settings/resource_and_prefix', 'GET');
        addLog('response', 'GET', '/api/downloader/settings/resource_and_prefix', serverResult.data);

        if (serverResult.success && serverResult.data) {
        document.getElementById('download-server').value = serverResult.data.Resource || serverResult.data.resource || '';
        document.getElementById('download-prefix').value = serverResult.data.Prefix || serverResult.data.prefix || '';

        originalSettings.server = serverResult.data.Resource || serverResult.data.resource || '';
        originalSettings.prefix = serverResult.data.Prefix || serverResult.data.prefix || '';
        }
        } catch (error) {
        console.error('Error loading server settings:', error);
        addLog('error', 'GET', '/api/downloader/settings/resource_and_prefix', error.message);
        }
        }

        async function saveServerSettings() {
        const server = document.getElementById('download-server').value.trim();
        const prefix = document.getElementById('download-prefix').value.trim();

        if (!server || !prefix) {
        showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø—Ä–µ—Ñ–∏–∫—Å–∞', 'warning');
        return;
        }

        try {
        addLog('request', 'PUT', '/api/downloader/settings/resource_and_prefix',
        { Resource: server, Prefix: prefix });
        const result = await makeRequest('/api/downloader/settings/resource_and_prefix', 'PUT', {
        Resource: server,
        Prefix: prefix
        });
        addLog('response', 'PUT', '/api/downloader/settings/resource_and_prefix', result);

        if (result.success) {
        showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        originalSettings.server = server;
        originalSettings.prefix = prefix;
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ä–≤–µ—Ä–∞', 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        function startServerMonitoring() {
        if (serverCheckInterval) clearInterval(serverCheckInterval);

        console.log('Starting server monitoring...');

        const checkServer = async () => {
        if (!isServerCheckActive || isCheckActive) return;

        try {
        const badge = document.getElementById('server-status-badge');

        try {
        const statusResponse = await fetch(`${SERVER_URL}/api/downloader/dl_server_status`);
        if (statusResponse.ok) {
        const statusData = await statusResponse.json();
        console.log('Server status response:', statusData);

        const status = statusData.Status; // "Processing", "Available", "Unavailable"

        if (status === 'Available') {
        badge.className = 'status-badge ready';
        badge.innerHTML = '‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω';
        } else if (status === 'Unavailable') {
        badge.className = 'status-badge fatal';
        badge.innerHTML = '‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤';
        } else { // Processing
        badge.className = 'status-badge waiting';
        badge.innerHTML = '‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞';
        }
        }
        } catch (error) {
        console.error('Status request failed:', error);
        badge.className = 'status-badge error';
        badge.innerHTML = '‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏';
        }

        } catch (error) {
        console.error('Server check error:', error);
        const badge = document.getElementById('server-status-badge');
        badge.className = 'status-badge error';
        badge.innerHTML = '‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏';
        }
        };

        checkServer();

        serverCheckInterval = setInterval(checkServer, 5000);
        }

        async function startAvailabilityCheck() {
        if (isCheckActive) {
        return;
        }

        const btn = document.getElementById('check-availability-btn');
        const originalState = {
        text: btn.innerHTML,
        disabled: btn.disabled,
        classList: [...btn.classList]
        };

        btn.innerHTML = '<span class="loading"></span> –ò–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞...';
        btn.disabled = true;
        btn.classList.add('btn-disabled');
        btn.classList.remove('btn');

        isServerCheckActive = false;
        if (serverCheckInterval) {
        clearInterval(serverCheckInterval);
        serverCheckInterval = null;
        }

        isCheckActive = true;
        checkStartTime = Date.now();
        longCheckNotificationShown = false;

        const badge = document.getElementById('server-status-badge');
        badge.className = 'status-badge waiting';
        badge.innerHTML = '<span class="loading"></span> –ò–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞...';

        try {
        addLog('request', 'POST', '/api/downloader/mesure_speed');
        const result = await makeRequest('/api/downloader/mesure_speed', 'POST');
        addLog('response', 'POST', '/api/downloader/mesure_speed', result);

        if (result.success) {
        showToast('–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ –Ω–∞—á–∞—Ç–∞', 'info');

        startCheckCycle(btn, originalState);
        } else {
        showToast('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: ' + result.message, 'error');
        resetCheckState(btn, originalState);
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        resetCheckState(btn, originalState);
        }
        }

        function startCheckCycle(btn, originalState) {
        if (serverCheckInterval) {
        clearInterval(serverCheckInterval);
        }

        serverCheckInterval = setInterval(async () => {
        try {
        const badge = document.getElementById('server-status-badge');

        try {
        const statusResponse = await fetch(`${SERVER_URL}/api/downloader/dl_server_status`);
        if (statusResponse.ok) {
        const statusData = await statusResponse.json();
        const status = statusData.Status; // "Processing", "Available", "Unavailable"

        if (status === 'Available') {
        clearInterval(serverCheckInterval);
        serverCheckInterval = null;
        badge.className = 'status-badge ready';
        badge.innerHTML = '‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω';
        resetCheckState(btn, originalState);
        showToast('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω.', 'success');

        } else if (status === 'Unavailable') {
        clearInterval(serverCheckInterval);
        serverCheckInterval = null;
        badge.className = 'status-badge fatal';
        badge.innerHTML = '‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤';
        resetCheckState(btn, originalState);
        showToast('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.', 'error');

        } else { // Processing
        badge.className = 'status-badge waiting';

        const elapsed = Date.now() - checkStartTime;
        if (elapsed > 30000) {
        badge.innerHTML = '<span class="loading"></span> –¢—Ä–∞—Ñ–∏–∫ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω—ã–π!';

        if (!longCheckNotificationShown) {
        showToast('–í–æ–∑–º–æ–∂–Ω–æ, –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.', 'warning');
        longCheckNotificationShown = true;
        }
        } else if (elapsed > 10000) {
        badge.innerHTML = '<span class="loading"></span> –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º';
        } else {
        badge.innerHTML = '<span class="loading"></span> –ò–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞...';
        }

        btn.innerHTML = '<span class="loading"></span> –ò–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞...';
        btn.disabled = true;
        btn.classList.add('btn-disabled');
        }
        }
        } catch (error) {
        console.error('Status request failed:', error);
        badge.className = 'status-badge error';
        badge.innerHTML = '‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏';
        }

        } catch (error) {
        console.error('Check cycle error:', error);
        const badge = document.getElementById('server-status-badge');
        badge.className = 'status-badge error';
        badge.innerHTML = '‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏';

        clearInterval(serverCheckInterval);
        serverCheckInterval = null;
        resetCheckState(btn, originalState);
        }
        }, 2000);
        }

        function resetCheckState(btn, originalState) {
        btn.innerHTML = originalState.text;
        btn.disabled = originalState.disabled;
        btn.classList.remove('btn-disabled');
        originalState.classList.forEach(cls => {
        if (cls !== 'btn-disabled') btn.classList.add(cls);
        });

        isServerCheckActive = true;
        isCheckActive = false;
        checkStartTime = null;
        longCheckNotificationShown = false;

        startServerMonitoring();
        }

        async function loadUserSettings() {
        try {
        addLog('request', 'GET', '/api/validator/settings/role_filter_level');
        const roleResult = await makeRequest('/api/validator/settings/role_filter_level', 'GET');
        addLog('response', 'GET', '/api/validator/settings/role_filter_level', roleResult.data);

        if (roleResult.success && roleResult.data) {
        const roleLevel = roleResult.data.RoleFilterLevel || roleResult.data.roleFilterLevel || 2;
        document.getElementById('role-level').value = roleLevel;
        originalSettings.roleLevel = roleLevel;
        }

        addLog('request', 'GET', '/api/validator/settings/whitelist_only');
        const modeResult = await makeRequest('/api/validator/settings/whitelist_only', 'GET');
        addLog('response', 'GET', '/api/validator/settings/whitelist_only', modeResult.data);

        if (modeResult.success && modeResult.data) {
        const accessMode = modeResult.data.Enabled || modeResult.data.enabled || false;
        document.getElementById('access-mode').value = accessMode;
        originalSettings.accessMode = accessMode;
        }
        } catch (error) {
        console.error('Error loading user settings:', error);
        addLog('error', 'GET', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', error.message);
        }
        }

        async function loadUserLists() {
        try {
        addLog('request', 'GET', '/api/white_list/users');
        const whiteResult = await makeRequest('/api/white_list/users', 'GET');
        addLog('response', 'GET', '/api/white_list/users', whiteResult.data);

        const whiteContainer = document.getElementById('whitelist-items');
        if (whiteResult.success && Array.isArray(whiteResult.data)) {
        whiteContainer.innerHTML = whiteResult.data.map(user =>
        `<div class="user-list-item">
        <span>${user}</span>
        <button onclick="removeUserFromWhitelist('${user}')" style="color: var(--red); background: none; border: none; cursor: pointer; font-size: 1.2rem;">√ó</button>
        </div>`
        ).join('');
        if (whiteResult.data.length === 0) {
        whiteContainer.innerHTML = '<span class="status-empty">–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç</span>';
        }
        }

        addLog('request', 'GET', '/api/black_list/users');
        const blackResult = await makeRequest('/api/black_list/users', 'GET');
        addLog('response', 'GET', '/api/black_list/users', blackResult.data);

        const blackContainer = document.getElementById('blacklist-items');
        if (blackResult.success && Array.isArray(blackResult.data)) {
        blackContainer.innerHTML = blackResult.data.map(user =>
        `<div class="user-list-item">
        <span>${user}</span>
        <button onclick="removeUserFromBlacklist('${user}')" style="color: var(--orange); background: none; border: none; cursor: pointer; font-size: 1.2rem;">√ó</button>
        </div>`
        ).join('');
        if (blackResult.data.length === 0) {
        blackContainer.innerHTML = '<span class="status-empty">–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç</span>';
        }
        }
        } catch (error) {
        console.error('Error loading user lists:', error);
        addLog('error', 'GET', '–°–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', error.message);
        }
        }

        async function saveUserSettings() {
        const roleLevel = parseInt(document.getElementById('role-level').value);
        const accessMode = document.getElementById('access-mode').value === 'true';

        try {
        addLog('request', 'PUT', '/api/validator/settings/role_filter_level', { RoleFilterLevel: roleLevel });
        const roleResult = await makeRequest('/api/validator/settings/role_filter_level', 'PUT', {
        RoleFilterLevel: roleLevel
        });
        addLog('response', 'PUT', '/api/validator/settings/role_filter_level', roleResult);

        addLog('request', 'PUT', '/api/validator/settings/whitelist_only', { Enabled: accessMode });
        const modeResult = await makeRequest('/api/validator/settings/whitelist_only', 'PUT', {
        Enabled: accessMode
        });
        addLog('response', 'PUT', '/api/validator/settings/whitelist_only', modeResult);

        if (roleResult.success && modeResult.success) {
        showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        originalSettings.roleLevel = roleLevel;
        originalSettings.accessMode = accessMode;
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫', 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function addToWhitelist() {
        const username = document.getElementById('allow-user-input').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        try {
        addLog('request', 'PUT', '/api/white_list/users', { UserName: username });
        const result = await makeRequest('/api/white_list/users', 'PUT', { UserName: username });
        addLog('response', 'PUT', '/api/white_list/users', result);

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫`, 'success');
        document.getElementById('allow-user-input').value = '';
        loadUserLists();
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function removeFromWhitelist() {
        const username = document.getElementById('allow-user-input').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        await removeUserFromWhitelist(username);
        }

        async function removeUserFromWhitelist(username) {
        try {
        addLog('request', 'DELETE', '/api/white_list/users', { UserName: username });
        const result = await makeRequest('/api/white_list/users', 'DELETE', { UserName: username });
        addLog('response', 'DELETE', '/api/white_list/users', result);

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —É–¥–∞–ª–µ–Ω –∏–∑ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞`, 'success');
        document.getElementById('allow-user-input').value = '';
        loadUserLists();
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function addToBlacklist() {
        const username = document.getElementById('block-user-input').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        try {
        addLog('request', 'PUT', '/api/black_list/users', { UserName: username });
        const result = await makeRequest('/api/black_list/users', 'PUT', { UserName: username });
        addLog('response', 'PUT', '/api/black_list/users', result);

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`, 'success');
        document.getElementById('block-user-input').value = '';
        loadUserLists();
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function removeFromBlacklist() {
        const username = document.getElementById('block-user-input').value.trim();
        if (!username) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
        return;
        }

        await removeUserFromBlacklist(username);
        }

        async function removeUserFromBlacklist(username) {
        try {
        addLog('request', 'DELETE', '/api/black_list/users', { UserName: username });
        const result = await makeRequest('/api/black_list/users', 'DELETE', { UserName: username });
        addLog('response', 'DELETE', '/api/black_list/users', result);

        if (result.success) {
        showToast(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`, 'success');
        document.getElementById('block-user-input').value = '';
        loadUserLists();
        markSettingsChanged();
        } else {
        showToast('–û—à–∏–±–∫–∞: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        function openChannelModal() {
        document.getElementById('channel-modal').classList.add('active');
        loadModalChannels();
        }

        function closeChannelModal() {
        document.getElementById('channel-modal').classList.remove('active');
        }

        async function loadModalChannels() {
        try {
        const result = await makeRequest('/api/irc_client/join', 'GET');
        const container = document.getElementById('modal-channels-list');

        if (result.success && Array.isArray(result.data)) {
        const channels = result.data
        .filter(c => c && (c.Channel || c.channel))
        .map(c => c.Channel || c.channel);

        if (channels.length > 0) {
        let html = '';
        channels.forEach(channel => {
        html += `
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; margin-bottom: 8px; background: rgba(255,255,255,0.03); border-radius: var(--radius-sm);">
        <span>${channel}</span>
        <button onclick="leaveChannelFromModal('${channel}')" style="padding: 6px 12px; background: rgba(255,56,96,0.1); color: var(--red); border: 1px solid var(--red); border-radius: 6px; cursor: pointer;">
        –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è
        </button>
        </div>
        `;
        });
        container.innerHTML = html;
        } else {
        container.innerHTML = '<div style="text-align: center; color: var(--text-light); padding: 20px;">–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</div>';
        }
        }
        } catch (error) {
        console.error('Error loading modal channels:', error);
        container.innerHTML = '<div style="text-align: center; color: var(--red); padding: 20px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
        }
        }

        async function leaveChannelFromModal(channel) {
        if (!confirm(`–û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç –∫–∞–Ω–∞–ª–∞ ${channel}?`)) return;

        try {
        await makeRequest('/api/irc_client/part', 'POST', { Channel: channel });
        loadModalChannels();
        loadChatChannelsList();
        showToast(`–û—Ç–∫–ª—é—á–∏–ª–∏—Å—å –æ—Ç –∫–∞–Ω–∞–ª–∞: ${channel}`, 'success');
        markSettingsChanged();
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function joinChannelFromModal() {
        const channel = document.getElementById('modal-channel-input').value.trim();
        if (!channel) {
        showToast('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞', 'warning');
        return;
        }

        try {
        await makeRequest('/api/irc_client/join', 'POST', { Channel: channel });
        showToast(`–ü–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ –∫–∞–Ω–∞–ª—É: ${channel}`, 'success');
        document.getElementById('modal-channel-input').value = '';
        loadModalChannels();
        loadChatChannelsList();
        markSettingsChanged();
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        }
        }

        async function saveAllSettings() {
        const saveBtn = document.getElementById('save-all-btn');
        const originalText = saveBtn.innerHTML;

        saveBtn.innerHTML = '<span class="loading"></span> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
        saveBtn.disabled = true;

        try {
        addLog('request', 'POST', '/api/settings/save');
        const result = await makeRequest('/api/settings/save', 'POST');
        addLog('response', 'POST', '/api/settings/save', result);

        if (result.success) {
        showToast('–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        markSettingsSaved();

        await loadFileSizeSettings();
        await loadServerSettings();
        await loadUserSettings();
        await loadCurrentFolder();

        startServerMonitoring();

        saveBtn.innerHTML = '<span>‚úÖ</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã';
        } else {
        showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + result.message, 'error');
        saveBtn.innerHTML = originalText;
        saveBtn.disabled = false;
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
        saveBtn.innerHTML = originalText;
        saveBtn.disabled = false;
        }
        }

        async function makeRequest(endpoint, method, data = null) {
        const url = SERVER_URL + endpoint;

        try {
        const options = {
        method: method,
        headers: {
        'Content-Type': 'application/json'
        }
        };

        if (method !== 'GET' && data !== null) {
        options.body = JSON.stringify(data);
        }

        const response = await fetch(url, options);
        const contentType = response.headers.get('content-type');
        let resultData;

        if (contentType && contentType.includes('application/json')) {
        try {
        resultData = await response.json();
        } catch (jsonError) {
        resultData = await response.text();
        }
        } else {
        resultData = await response.text();
        }

        return {
        success: response.ok,
        message: resultData,
        data: response.ok ? resultData : null,
        status: response.status
        };
        } catch (error) {
        console.error('Request error:', error);
        return {
        success: false,
        message: '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + error.message,
        data: null
        };
        }
        }

        async function loadSettings() {
        try {
        addLog('request', 'POST', '/api/settings/load');
        const result = await makeRequest('/api/settings/load', 'POST');
        addLog('response', 'POST', '/api/settings/load', result);

        if (result.success) {
        showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
        loadCurrentFolder();
        loadChatChannelsList();
        loadFileSizeSettings();
        loadServerSettings();
        loadUserSettings();
        loadUserLists();
        startServerMonitoring();
        markSettingsSaved();
        } else {
        showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞: ' + error.message, 'error');
        }
        }

        async function saveSettings() {
        try {
        addLog('request', 'POST', '/api/settings/save');
        const result = await makeRequest('/api/settings/save', 'POST');
        addLog('response', 'POST', '/api/settings/save', result);

        if (result.success) {
        showToast('–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        markSettingsSaved();
        } else {
        showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + result.message, 'error');
        }
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞: ' + error.message, 'error');
        }
        }

        async function checkAllStatuses() {
        try {
        await loadCurrentFolder();
        await loadChatChannelsList();
        await startServerMonitoring();
        showToast('–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
        } catch (error) {
        showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤: ' + error.message, 'error');
        }
        }

        function refreshChannels() {
        loadChatChannelsList();
        showToast('–°–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω', 'info');
        }

        function showToast(message, type = 'info') {
        document.querySelectorAll('.toast').forEach(toast => toast.remove());

        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;
        toast.innerHTML = `
        <span>${message}</span>
        <button onclick="this.parentElement.remove()" style="background: none; border: none; color: white; font-size: 1.2rem; cursor: pointer; opacity: 0.7; transition: opacity 0.2s; padding: 0 0 0 10px;">√ó</button>
        `;

        document.body.appendChild(toast);

        setTimeout(() => {
        if (toast.parentElement) {
        toast.remove();
        }
        }, 5000);
        }

        document.addEventListener('DOMContentLoaded', function() {
        initParticles();

        document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
        navigateToSection(this.dataset.section);
        });
        });

        document.getElementById('max-file-size').addEventListener('change', markSettingsChanged);
        document.getElementById('download-server').addEventListener('input', markSettingsChanged);
        document.getElementById('download-prefix').addEventListener('input', markSettingsChanged);
        document.getElementById('role-level').addEventListener('change', markSettingsChanged);
        document.getElementById('access-mode').addEventListener('change', markSettingsChanged);
        document.getElementById('folder-path-input').addEventListener('input', markSettingsChanged);
        document.getElementById('new-channel').addEventListener('input', markSettingsChanged);

        loadCurrentFolder();
        loadChatChannelsList();
        loadFileSizeSettings();
        loadServerSettings();
        loadUserSettings();
        loadUserLists();

        startServerMonitoring();

        setTimeout(() => {
        if (document.getElementById('dashboard-section').classList.contains('active')) {
        console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã');
        startAvailabilityCheck();
        }
        }, 1000);

        updateSaveButtonState();

        addLog('response', 'INFO', '–°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞', {
        timestamp: new Date().toISOString(),
        server: SERVER_URL
        });
        });

        window.addEventListener('beforeunload', function() {
        if (serverCheckInterval) clearInterval(serverCheckInterval);
        });
    </script>
</body>
</html>